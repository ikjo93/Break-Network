### XSS(Cross Site Scripting)
+ 공격자가 상대방의 브라우저에 스크립트가 실행되도록 해 사용자의 세션을 가로채거나, 웹사이트를 변조하거나, 악의적 콘텐츠를 삽입하거나, 피싱 공격을 진행하는 것

<br/>

### Stored XSS
+ 공격자가 제공한 데이터가 **서버에 저장된 후** 지속적으로 서비스를 제공하는 정상 페이지에서 **다른 사용자에게 스크립트가 노출**되는 기법
+ 예시
```
1. 해커가 게시판 웹 사이트에 특정 글 작성 시 내용작성란 등에 다음과 같은 스크립트문을 작성한다.

<script>
  alert("Hello!");
</script>

2. 특정 사용자가 해당 글을 조회하는 경우 위 스크립트문이 실행됨

3. 단순 alert가 아니라 악의적인 액션도 가능

예를 들어 C&C(좀비 PC에 명령을 내리거나 악성 코드를 제어하는 서버)로 리다이렉트하거나 사용자의 로컬스토리지 내지 세션스토리지 등에 접근하여 사용자의 쿠키를 탈취하여 세션 하이재킹 공격

```

<br/>

### Reflected XSS
+ 웹 앱의 **지정된 파라미터를 사용**할 때 발생하는 취약점을 이용한 공격 기법
  + 검색어 같은 쿼리스트링을 URL에 담아 전송했을 때, **서버가 필터링을 거치지 않고** 쿼리에 포함된 스크립트를 응답 페이지에 담아 전송함으로써 발생
+ 공격용 스크립트가 웹 앱에 있지 않고 다른 매체(타 사이트, 이메일)에 포함될 수 있다.
+ Stored XSS와는 다르게 데이터베이스에 스크립트가 저장되지 않고 응답 페이지로 바로 클라이언트에 전달된다.
+ 예시
```
1. 해커가 특정 URL에 q 파라미터(쿼리 스트링)의 값에 다음과 같이 스크립트문을 작성한다.

http://ikjo.com/search?q=<script>alert("Hello!")</script>

2. 서버는 이 요청을 받았을 때 해당 파라미터를 필터하지 않고 응답 바디에 해당 값을 그대로 노출시킨다고 가정

3. 해당 URL이 여러 매체를 통해 전파된다. 

4. 해당 URL에 접속한 사용자는 앞선 서버로부터 응답 결과를 받고 응답 바디에 있는 스크립트문이 실행된다.

5. 단순 alert가 아니라 악의적인 액션도 가능

```

<br/>

### XSS 대책
+ 클라이언트 단에서 XSS 취약점이 있는 innerHTML 사용을 자제한다.
  + 그래도 HTML5에서는 innerHTML을 통해 주입한 스크립트는 실행되지 않는다.
  + 하지만 onerror 이벤트 송석을 통한 스크립트 주입 시 스크립트 실행 가능
  + 가급적 innerHTML로 검증되지 않은 데이터를 넣지 않고 textContent나 innetText를 사용하자(스크립트 실행 X)
+ 쿠키에 HttpOnly 옵션 활성화
  + 활성화 하지 않을 경우 스크립트를 통해 쿠키에 접근할 수 있어 세션 하이재킹(Session Hijacking) 취약점 발생
  + 악의적인 클라이언트가 쿠키에 저장된 저장된 정보에 접근하는 것을 차단
  + 로컬 스토리지는 이를 막을 방법이 없다. → 로컬 스토리지에 세션 ID와 같은 민감 정보를 저장하지 않는다.
+ 서버에서 XSS 특수문자를 치환
  + Spring에서는 직접 구현하지 않아도 오픈소스 라이브러리 사용 → Lucy XSS Servlet Filter
    + but, @RequestBody로 전달되는 JSON 요청에 대해서는 처리해주지 않는다.

<br/>

### 참고자료
+ `https://www.youtube.com/watch?v=bSGqBoZd8WM`
